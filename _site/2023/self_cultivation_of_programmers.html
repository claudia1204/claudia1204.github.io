<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <title>《程序员的自我修养》读书笔记</title>
  <meta name="description" content="1 背景知识">
  <meta name="author" content="leopardpan">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="《程序员的自我修养》读书笔记">
  <meta name="twitter:description" content="1 背景知识">

  <meta property="og:type" content="article">
  <meta property="og:title" content="《程序员的自我修养》读书笔记">
  <meta property="og:description" content="1 背景知识">

  <link rel="icon" type="image/png" href="/images/favicon.png" />
  <link href="/images/favicon.png" rel="shortcut icon" type="image/png">

  <link rel="stylesheet" href="/css/main.css">
  <link href="//netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet">

  <link rel="canonical" href="http://localhost:8080/2023/self_cultivation_of_programmers.html">
  <link rel="alternate" type="application/rss+xml" title="keep moving" href="http://localhost:8080/feed.xml">

  <meta name="google-site-verification" content="1-1ZlHoRvM0T2FqPbW2S-qLgYXN6rsn52kErlMPd_gw" />

<!-- 站点统计 -->
  <script
  async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js">
  </script>

<!-- 百度统计 -->
  
  <script>
      var _hmt = _hmt || [];
      (function() {
        var hm = document.createElement("script");
        hm.src = "//hm.baidu.com/hm.js?625129f6a6c1cc07fc945a8fb5dbc0b4";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
      })();
  </script>
  

<!-- google 统计 -->
  

  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2487558142971429"
          crossorigin="anonymous"></script>
</head>


  <body>
    <span class="mobile btn-mobile-menu">
      <div class="nav_container">
         <nav class="nav-menu-item" style = "float:right">
            <i class="nav-menu-item">
              <a href="/archive" title="" class="blog-button">  博客主页
              </a>
            </i>
            
                <i class="nav-menu-item">

                  <a href="/archive" title="archive" class="btn-mobile-menu__icon">
                      所有文章
                  </a>
                </i>
            
                <i class="nav-menu-item">

                  <a href="/tags" title="tags" class="btn-mobile-menu__icon">
                      标签
                  </a>
                </i>
            
                <i class="nav-menu-item">

                  <a href="/about" title="about" class="btn-mobile-menu__icon">
                      关于我
                  </a>
                </i>
            
          </nav>
      </div>
    </span>

    <header class="panel-cover panel-cover--collapsed" style="background-image: url('/images/background-cover.jpg')">
  <div class="panel-main">

    <div class="panel-main__inner panel-inverted">
    <div class="panel-main__content">
        <!-- 头像效果-start -->
        <div class="ih-item circle effect right_to_left">            
            <a href="/#blog" title="前往 keep moving 的主页" class="blog-button">
                <div class="img"><img src="/images/avatar.jpg" alt="img"></div>
                <div class="info">
                    <div class="info-back">
                        <h2> 
                            
                                claudia
                            
                        </h2>
                        <p>
                           
                                frontend / python
                            
                        </p>
                    </div>
                </div>
            </a>
        </div>
        <!-- 头像效果-end -->
        <h1 class="panel-cover__title panel-title"><a href="/#blog" title="link to homepage for keep moving" class="blog-button">keep moving</a></h1>
        
        <hr class="panel-cover__divider" />
        <p class="panel-cover__description">small world</p>
        <hr class="panel-cover__divider panel-cover__divider--secondary" />
        
        
        

        <div class="navigation-wrapper">
          <div>
            <nav class="cover-navigation cover-navigation--primary">
              <ul class="navigation">
                <li class="navigation__item"><a href="/#blog" title="" class="blog-button">博客主页</a></li>
                
                  <li class="navigation__item"><a href="/archive" title="archive">所有文章</a></li>
                
                  <li class="navigation__item"><a href="/tags" title="tags">标签</a></li>
                
                  <li class="navigation__item"><a href="/about" title="about">关于我</a></li>
                
              </ul>
            </nav>
          </div>          
        </div>


        </div>
      </div>
    </div>
    
    
    <div class="panel-cover--overlay cover-clear"></div>
    
  </div>
</header>


    <div class="content-wrapper">
        <div class="content-wrapper__inner">
            <article class="post-container post-container--single" itemscope itemtype="http://schema.org/BlogPosting">
  <header class="post-header">
    <h1 class="post-title">《程序员的自我修养》读书笔记</h1>
    <div class="post-meta">
      <img src="/images/calendar.png" width="20px"/> 
      <time datetime="2023-10-07 19:29:41 +0800" itemprop="datePublished" class="post-meta__date date">2023-10-07</time>  
         
      <span id="busuanzi_container_page_pv"> | 阅读：<span id="busuanzi_value_page_pv"></span>次</span>
    </p>
    </div>
  </header>

  <section class="post">
    <h2 id="1-背景知识">1 背景知识</h2>

<p>进程process p：</p>

<p>thread a</p>

<p>thread b</p>

<p><strong>thread ab可共享进程p的数据：</strong></p>

<ul>
  <li>全局变量</li>
  <li>堆数据</li>
  <li>函数里的静态变量</li>
  <li>程序代码，任何线程都有权利读取并执行任何代码</li>
  <li>打开的文件，A线程打开的文件可由B线程读写</li>
</ul>

<p><strong>thread的私有空间：</strong></p>

<ul>
  <li>局部变量</li>
  <li>栈</li>
  <li>函数的参数</li>
  <li>TLS（线程局部存储）</li>
  <li>寄存器</li>
</ul>

<p><img src="../images/2023-10-7-self_cultivation_of_programmers.assets/image-20231007141653498.png" alt="image-20231007141653498" style="zoom: 67%;" /></p>

<p>fork一个进程，linux采用写时复制。因此在只读的情况下fork进程特别快。</p>

<p>fork：产生本任务的镜像，exec启动新任务。</p>

<p>clone：产生新的线程，从指定位置开始执行，(可选的)共享当前进程的内存空间、文件等。实际效果上产生一个线程。</p>

<p><img src="../images/2023-10-7-self_cultivation_of_programmers.assets/image-20231007145636508.png" alt="image-20231007145636508" style="zoom: 50%;" /></p>

<p><img src="../images/2023-10-7-self_cultivation_of_programmers.assets/image-20231007145919899.png" alt="image-20231007145919899" style="zoom: 50%;" /></p>

<h2 id="2--静态链接">2  静态链接</h2>

<p>gcc hello.c</p>

<p>a.out</p>

<p>上述过程分解为4个步骤：预处理、编译、汇编、链接</p>

<h3 id="21-看不见的过程">2.1 看不见的过程</h3>

<h4 id="211-预编译">2.1.1 预编译：</h4>

<ul>
  <li>
    <p>展开宏定义</p>
  </li>
  <li>
    <p>替换include为文件内容，此处可能会递归调用</p>
  </li>
  <li>
    <p>处理条件预编译指令，例如“#if”、“#ifdef”、“#elif”、“#else”、“endif”</p>
  </li>
  <li>
    <p>删除所有的注释：“//”和“/* */”</p>
  </li>
  <li>
    <p>添加行号和文件名标识，比如#2 “hello.c” 2, 以便于编译时产生调试用的行号信息以及用于编译时产生编译错误或者警告时能够显示行号</p>
  </li>
  <li>
    <p>保留所有#pragma编译器指令</p>
  </li>
</ul>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>gcc -E hello.c -o hello.i
</code></pre></div></div>

<p><img src="/images/2023-10-7-self_cultivation_of_programmers.assets/image-20231007150927263.png" alt="image-20231007150927263" /></p>

<h4 id="212-编译">2.1.2 编译</h4>

<p>把预处理完的文件—————(<strong>词法分析、语法分析、语义分析及优化后)</strong>—————&gt;生成汇编代码</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>gcc -S hello.i -o hello.s
cat hello.s
        .file   "hello.c"
        .text
        .globl  main
        .type   main, @function
main:
.LFB0:
        .cfi_startproc
        pushq   %rbp
        .cfi_def_cfa_offset 16
        .cfi_offset 6, -16
        movq    %rsp, %rbp
        .cfi_def_cfa_register 6
        movl    $0, %eax
        popq    %rbp
        .cfi_def_cfa 7, 8
        ret
        .cfi_endproc
.LFE0:
        .size   main, .-main
        .ident  "GCC: (Ubuntu 7.5.0-3ubuntu1~18.04) 7.5.0"
        .section        .note.GNU-stack,"",@progbits

</code></pre></div></div>

<p><img src="../images/2023-10-7-self_cultivation_of_programmers.assets/image-20231007151710553.png" alt="image-20231007151710553" style="zoom:67%;" /></p>

<h4 id="213-汇编">2.1.3 汇编</h4>

<p>汇编代码S —–&gt; 机器可执行的指令</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>gcc -c hello.s -o hello.o
</code></pre></div></div>

<h4 id="214-链接">2.1.4 链接</h4>

<p><img src="../images/2023-10-7-self_cultivation_of_programmers.assets/image-20231007152233218.png" alt="image-20231007152233218" style="zoom: 50%;" /></p>

<h3 id="22-编译器">2.2 编译器</h3>

<p><img src="../images/2023-10-7-self_cultivation_of_programmers.assets/image-20231007152843683.png" alt="image-20231007152843683" style="zoom: 50%;" /></p>

<h4 id="221-词法分析">2.2.1 词法分析</h4>

<p>使用有限状态机的算法将源代码字符序列分割成一系列token。</p>

<p>词法分析产生的记号一般可分为以下几类：</p>

<p>关键字、标识符、字面量（数字、字符串）、特殊符号（+、=）</p>

<p>词法扫描现有工具：lex。根据词法规则将输入字符串分割成一个个记号。</p>

<p>C语言宏替换和文件包含等工作一般交给一个独立的预处理器</p>

<h4 id="222-语法分析">2.2.2 语法分析</h4>

<p>语法分析器产生语法树。分析过程采用上下文无关语法的分析手段。</p>

<p>语法分析现有工具：yacc。根据语法规则进行解析构造一颗语法树</p>

<h4 id="223-语义分析">2.2.3 语义分析</h4>

<p>静态语义：编译期就可以确定的语义。通常包括声明和类型的匹配，类型的转换。</p>

<p>动态语义：程序执行时才能确定的语义</p>

<p>编译器分析静态语义，比如一个浮点数赋值给整型表达式时，隐含包含了一个浮点型到整型的转换过程。类型转换是否合法。经过语义分析阶段后语法树表达式都被标识了类型。如果有些类型需要语法转换，则语义分析程序会在语法树中插入相应的转换节点。</p>

<p><img src="../images/2023-10-7-self_cultivation_of_programmers.assets/image-20231007154512472.png" alt="image-20231007154512472" style="zoom: 50%;" /></p>

<h4 id="224-链接">2.2.4 链接</h4>

<p><img src="../images/2023-10-7-self_cultivation_of_programmers.assets/image-20231007155519336.png" alt="image-20231007155519336" style="zoom: 50%;" /></p>

<p><img src="../images/2023-10-7-self_cultivation_of_programmers.assets/image-20231007155633302.png" alt="image-20231007155633302" style="zoom: 50%;" /></p>

<h2 id="3-可执行文件">3 可执行文件</h2>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>// <span class="nt">-h</span>打印各个段的基本信息
objdump <span class="nt">-h</span> hello.o

hello.o:     file format elf64-x86-64

Sections:
Idx Name          Size      VMA               LMA               File off  Algn
  0 .text         00000017  0000000000000000  0000000000000000  00000040  2<span class="k">**</span>0
                  CONTENTS, ALLOC, LOAD, RELOC, READONLY, CODE
  1 .data         00000000  0000000000000000  0000000000000000  00000057  2<span class="k">**</span>0
                  CONTENTS, ALLOC, LOAD, DATA
  2 .bss          00000000  0000000000000000  0000000000000000  00000057  2<span class="k">**</span>0
                  ALLOC
  3 .rodata       0000000c  0000000000000000  0000000000000000  00000057  2<span class="k">**</span>0
                  CONTENTS, ALLOC, LOAD, READONLY, DATA
  4 .comment      0000002a  0000000000000000  0000000000000000  00000063  2<span class="k">**</span>0
                  CONTENTS, READONLY
  5 .note.GNU-stack 00000000  0000000000000000  0000000000000000  0000008d  2<span class="k">**</span>0
                  CONTENTS, READONLY
  6 .eh_frame     00000038  0000000000000000  0000000000000000  00000090  2<span class="k">**</span>3
                  CONTENTS, ALLOC, LOAD, RELOC, READONLY, DATA

                  
// <span class="nt">-x</span>打印更详细的内容
 objdump <span class="nt">-x</span> hello.o

hello.o:     file format elf64-x86-64
hello.o
architecture: i386:x86-64, flags 0x00000011:
HAS_RELOC, HAS_SYMS
start address 0x0000000000000000

Sections:
Idx Name          Size      VMA               LMA               File off  Algn
  0 .text         00000017  0000000000000000  0000000000000000  00000040  2<span class="k">**</span>0
                  CONTENTS, ALLOC, LOAD, RELOC, READONLY, CODE
  1 .data         00000000  0000000000000000  0000000000000000  00000057  2<span class="k">**</span>0
                  CONTENTS, ALLOC, LOAD, DATA
  2 .bss          00000000  0000000000000000  0000000000000000  00000057  2<span class="k">**</span>0
                  ALLOC
  3 .rodata       0000000c  0000000000000000  0000000000000000  00000057  2<span class="k">**</span>0
                  CONTENTS, ALLOC, LOAD, READONLY, DATA
  4 .comment      0000002a  0000000000000000  0000000000000000  00000063  2<span class="k">**</span>0
                  CONTENTS, READONLY
  5 .note.GNU-stack 00000000  0000000000000000  0000000000000000  0000008d  2<span class="k">**</span>0
                  CONTENTS, READONLY
  6 .eh_frame     00000038  0000000000000000  0000000000000000  00000090  2<span class="k">**</span>3
                  CONTENTS, ALLOC, LOAD, RELOC, READONLY, DATA
SYMBOL TABLE:
0000000000000000 l    <span class="nb">df</span> <span class="k">*</span>ABS<span class="k">*</span>  0000000000000000 hello.c
0000000000000000 l    d  .text  0000000000000000 .text
0000000000000000 l    d  .data  0000000000000000 .data
0000000000000000 l    d  .bss   0000000000000000 .bss
0000000000000000 l    d  .rodata        0000000000000000 .rodata
0000000000000000 l    d  .note.GNU-stack        0000000000000000 .note.GNU-stack
0000000000000000 l    d  .eh_frame      0000000000000000 .eh_frame
0000000000000000 l    d  .comment       0000000000000000 .comment
0000000000000000 g     F .text  0000000000000017 main
0000000000000000         <span class="k">*</span>UND<span class="k">*</span>  0000000000000000 _GLOBAL_OFFSET_TABLE_
0000000000000000         <span class="k">*</span>UND<span class="k">*</span>  0000000000000000 puts


RELOCATION RECORDS FOR <span class="o">[</span>.text]:
OFFSET           TYPE              VALUE
0000000000000007 R_X86_64_PC32     .rodata-0x0000000000000004
000000000000000c R_X86_64_PLT32    puts-0x0000000000000004


RELOCATION RECORDS FOR <span class="o">[</span>.eh_frame]:
OFFSET           TYPE              VALUE
0000000000000020 R_X86_64_PC32     .text


// 以十六进制打印hello.o所有段的内容
objdump <span class="nt">-s</span> hello.o
hello.o:     file format elf64-x86-64

Contents of section .text:
 0000 554889e5 488d3d00 000000e8 00000000  UH..H.<span class="o">=</span>.........
 0010 b8000000 005dc3                      .....].
Contents of section .rodata:
 0000 68656c6c 6f20776f 726c6400           hello world.
Contents of section .comment:
 0000 00474343 3a202855 62756e74 7520372e  .GCC: <span class="o">(</span>Ubuntu 7.
 0010 352e302d 33756275 6e747531 7e31382e  5.0-3ubuntu1~18.
 0020 30342920 372e352e 3000               04<span class="o">)</span> 7.5.0.
Contents of section .eh_frame:
 0000 14000000 00000000 017a5200 01781001  .........zR..x..
 0010 1b0c0708 90010000 1c000000 1c000000  ................
 0020 00000000 17000000 00410e10 8602430d  .........A....C.
 0030 06520c07 08000000                    .R......

// 以十六进制打印hello.o所有段的内容。且“-d”对内容进行反汇编
objdump <span class="nt">-s</span> <span class="nt">-d</span> hello.o

hello.o:     file format elf64-x86-64

Contents of section .text:
 0000 554889e5 488d3d00 000000e8 00000000  UH..H.<span class="o">=</span>.........
 0010 b8000000 005dc3                      .....].
Contents of section .rodata:
 0000 68656c6c 6f20776f 726c6400           hello world.
Contents of section .comment:
 0000 00474343 3a202855 62756e74 7520372e  .GCC: <span class="o">(</span>Ubuntu 7.
 0010 352e302d 33756275 6e747531 7e31382e  5.0-3ubuntu1~18.
 0020 30342920 372e352e 3000               04<span class="o">)</span> 7.5.0.
Contents of section .eh_frame:
 0000 14000000 00000000 017a5200 01781001  .........zR..x..
 0010 1b0c0708 90010000 1c000000 1c000000  ................
 0020 00000000 17000000 00410e10 8602430d  .........A....C.
 0030 06520c07 08000000                    .R......

Disassembly of section .text:

0000000000000000 &lt;main&gt;: // 左边一列偏移量。 中间十六进制表示，右边ascii码表示
   0:   55                      push   %rbp
   1:   48 89 e5                mov    %rsp,%rbp
   4:   48 8d 3d 00 00 00 00    lea    0x0<span class="o">(</span>%rip<span class="o">)</span>,%rdi        <span class="c"># b &lt;main+0xb&gt;</span>
   b:   e8 00 00 00 00          callq  10 &lt;main+0x10&gt;
  10:   b8 00 00 00 00          mov    <span class="nv">$0x0</span>,%eax
  15:   5d                      pop    %rbp
  16:   c3                      retq

</code></pre></div></div>

<p>printf里的字符串为常量，放到rodata里，<code class="highlighter-rouge">rodata       0000000c</code> 可以看到该字符串12字节长度。</p>

<p>rodata：只读数据。一般用来存储全局const常量或者字符串常量。</p>

<p><img src="../images/2023-10-7-self_cultivation_of_programmers.assets/image-20231007105055689.png" alt="image-20231007105055689" style="zoom: 50%;" /></p>

<h3 id="34-elf文件结构描述">3.4 ELF文件结构描述</h3>

<p><img src="../images/2023-10-7-self_cultivation_of_programmers.assets/image-20231007113746295.png" alt="image-20231007113746295" style="zoom: 50%;" /></p>

<h4 id="341-文件头">3.4.1 文件头</h4>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> readelf -h hello.o
ELF Header:
  Magic:   7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00
  Class:                             ELF64
  Data:                              2's complement, little endian // 数据存储方式
  Version:                           1 (current)
  OS/ABI:                            UNIX - System V
  ABI Version:                       0
  Type:                              REL (Relocatable file)
  Machine:                           Advanced Micro Devices X86-64
  Version:                           0x1
  Entry point address:               0x0
  Start of program headers:          0 (bytes into file)
  Start of section headers:          760 (bytes into file)
  Flags:                             0x0
  Size of this header:               64 (bytes)
  Size of program headers:           0 (bytes)
  Number of program headers:         0
  Size of section headers:           64 (bytes)
  Number of section headers:         13
  Section header string table index: 12
</code></pre></div></div>

<h4 id="342-符号">3.4.2 符号</h4>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>// 显示符号表信息。变量和函数都是符号
readelf -s hello.o

Symbol table '.symtab' contains 13 entries:
   Num:    Value          Size Type    Bind   Vis      Ndx Name
     0: 0000000000000000     0 NOTYPE  LOCAL  DEFAULT  UND
     1: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS hello.c
     2: 0000000000000000     0 SECTION LOCAL  DEFAULT    1
     3: 0000000000000000     0 SECTION LOCAL  DEFAULT    3
     4: 0000000000000000     0 SECTION LOCAL  DEFAULT    4
     5: 0000000000000000     0 SECTION LOCAL  DEFAULT    5
     6: 0000000000000000     0 SECTION LOCAL  DEFAULT    7
     7: 0000000000000000     0 SECTION LOCAL  DEFAULT    8
     8: 0000000000000000     0 SECTION LOCAL  DEFAULT    6
     9: 0000000000000000     4 OBJECT  GLOBAL DEFAULT    3 global_init_var
    10: 0000000000000000    23 FUNC    GLOBAL DEFAULT    1 main
    11: 0000000000000000     0 NOTYPE  GLOBAL DEFAULT  UND _GLOBAL_OFFSET_TABLE_
    12: 0000000000000000     0 NOTYPE  GLOBAL DEFAULT  UND puts
</code></pre></div></div>

<h2 id="6-可执行文件的装载">6 可执行文件的装载</h2>

<p>静态编译成elf文件，然后查看信息</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>gcc <span class="nt">-static</span> hello.o <span class="nt">-o</span> hello.elf
readelf <span class="nt">-S</span> hello.elf
There are 33 section headers, starting at offset 0xcdda0:

Section Headers:
  <span class="o">[</span>Nr] Name              Type             Address           Offset
       Size              EntSize          Flags  Link  Info  Align
  <span class="o">[</span> 0]                   NULL             0000000000000000  00000000
       0000000000000000  0000000000000000           0     0     0
  <span class="o">[</span> 1] .note.ABI-tag     NOTE             0000000000400190  00000190
       0000000000000020  0000000000000000   A       0     0     4
  <span class="o">[</span> 2] .note.gnu.build-i NOTE             00000000004001b0  000001b0
       0000000000000024  0000000000000000   A       0     0     4
readelf: Warning: <span class="o">[</span> 3]: Link field <span class="o">(</span>0<span class="o">)</span> should index a symtab section.
  <span class="o">[</span> 3] .rela.plt         RELA             00000000004001d8  000001d8
       0000000000000228  0000000000000018  AI       0    20     8
  <span class="o">[</span> 4] .init             PROGBITS         0000000000400400  00000400
       0000000000000017  0000000000000000  AX       0     0     4
  <span class="o">[</span> 5] .plt              PROGBITS         0000000000400418  00000418
       00000000000000b8  0000000000000000  AX       0     0     8
  <span class="o">[</span> 6] .text             PROGBITS         00000000004004d0  000004d0
       000000000008f640  0000000000000000  AX       0     0     16
  <span class="o">[</span> 7] __libc_freeres_fn PROGBITS         000000000048fb10  0008fb10
       0000000000001523  0000000000000000  AX       0     0     16
  <span class="o">[</span> 8] __libc_thread_fre PROGBITS         0000000000491040  00091040
       00000000000010eb  0000000000000000  AX       0     0     16
  <span class="o">[</span> 9] .fini             PROGBITS         000000000049212c  0009212c
       0000000000000009  0000000000000000  AX       0     0     4
  <span class="o">[</span>10] .rodata           PROGBITS         0000000000492140  00092140
       000000000001926c  0000000000000000   A       0     0     32
  <span class="o">[</span>11] .stapsdt.base     PROGBITS         00000000004ab3ac  000ab3ac
       0000000000000001  0000000000000000   A       0     0     1
  <span class="o">[</span>12] .eh_frame         PROGBITS         00000000004ab3b0  000ab3b0
       000000000000a5e8  0000000000000000   A       0     0     8
  <span class="o">[</span>13] .gcc_except_table PROGBITS         00000000004b5998  000b5998
       000000000000009e  0000000000000000   A       0     0     1
  <span class="o">[</span>14] .tdata            PROGBITS         00000000006b6120  000b6120
       0000000000000020  0000000000000000 WAT       0     0     8
  <span class="o">[</span>15] .tbss             NOBITS           00000000006b6140  000b6140
       0000000000000040  0000000000000000 WAT       0     0     8
  <span class="o">[</span>16] .init_array       INIT_ARRAY       00000000006b6140  000b6140
       0000000000000010  0000000000000008  WA       0     0     8
  <span class="o">[</span>17] .fini_array       FINI_ARRAY       00000000006b6150  000b6150
       0000000000000010  0000000000000008  WA       0     0     8
  <span class="o">[</span>18] .data.rel.ro      PROGBITS         00000000006b6160  000b6160
       0000000000002d94  0000000000000000  WA       0     0     32
  <span class="o">[</span>19] .got              PROGBITS         00000000006b8ef8  000b8ef8
       00000000000000f8  0000000000000000  WA       0     0     8
  <span class="o">[</span>20] .got.plt          PROGBITS         00000000006b9000  000b9000
       00000000000000d0  0000000000000008  WA       0     0     8
  <span class="o">[</span>21] .data             PROGBITS         00000000006b90e0  000b90e0
       0000000000001af0  0000000000000000  WA       0     0     32
  <span class="o">[</span>22] __libc_subfreeres PROGBITS         00000000006babd0  000babd0
       0000000000000048  0000000000000000  WA       0     0     8
  <span class="o">[</span>23] __libc_IO_vtables PROGBITS         00000000006bac20  000bac20
       00000000000006a8  0000000000000000  WA       0     0     32
  <span class="o">[</span>24] __libc_atexit     PROGBITS         00000000006bb2c8  000bb2c8
       0000000000000008  0000000000000000  WA       0     0     8
  <span class="o">[</span>25] __libc_thread_sub PROGBITS         00000000006bb2d0  000bb2d0
       0000000000000008  0000000000000000  WA       0     0     8
  <span class="o">[</span>26] .bss              NOBITS           00000000006bb2e0  000bb2d8
       00000000000016f8  0000000000000000  WA       0     0     32
  <span class="o">[</span>27] __libc_freeres_pt NOBITS           00000000006bc9d8  000bb2d8
       0000000000000028  0000000000000000  WA       0     0     8
  <span class="o">[</span>28] .comment          PROGBITS         0000000000000000  000bb2d8
       0000000000000029  0000000000000001  MS       0     0     1
  <span class="o">[</span>29] .note.stapsdt     NOTE             0000000000000000  000bb304
       0000000000001638  0000000000000000           0     0     4
  <span class="o">[</span>30] .symtab           SYMTAB           0000000000000000  000bc940
       000000000000a9b0  0000000000000018          31   679     8
  <span class="o">[</span>31] .strtab           STRTAB           0000000000000000  000c72f0
       0000000000006938  0000000000000000           0     0     1
  <span class="o">[</span>32] .shstrtab         STRTAB           0000000000000000  000cdc28
       0000000000000176  0000000000000000           0     0     1
Key to Flags:
  W <span class="o">(</span>write<span class="o">)</span>, A <span class="o">(</span>alloc<span class="o">)</span>, X <span class="o">(</span>execute<span class="o">)</span>, M <span class="o">(</span>merge<span class="o">)</span>, S <span class="o">(</span>strings<span class="o">)</span>, I <span class="o">(</span>info<span class="o">)</span>,
  L <span class="o">(</span><span class="nb">link </span>order<span class="o">)</span>, O <span class="o">(</span>extra OS processing required<span class="o">)</span>, G <span class="o">(</span>group<span class="o">)</span>, T <span class="o">(</span>TLS<span class="o">)</span>,
  C <span class="o">(</span>compressed<span class="o">)</span>, x <span class="o">(</span>unknown<span class="o">)</span>, o <span class="o">(</span>OS specific<span class="o">)</span>, E <span class="o">(</span>exclude<span class="o">)</span>,
  l <span class="o">(</span>large<span class="o">)</span>, p <span class="o">(</span>processor specific<span class="o">)</span>
  

readelf <span class="nt">-l</span> hello.elf

Elf file <span class="nb">type </span>is EXEC <span class="o">(</span>Executable file<span class="o">)</span>
Entry point 0x400a50
There are 6 program headers, starting at offset 64

Program Headers:
  Type           Offset             VirtAddr           PhysAddr
                 FileSiz            MemSiz              Flags  Align
  LOAD           0x0000000000000000 0x0000000000400000 0x0000000000400000
                 0x00000000000b5a36 0x00000000000b5a36  R E    0x200000
  LOAD           0x00000000000b6120 0x00000000006b6120 0x00000000006b6120
                 0x00000000000051b8 0x00000000000068e0  RW     0x200000
  NOTE           0x0000000000000190 0x0000000000400190 0x0000000000400190
                 0x0000000000000044 0x0000000000000044  R      0x4
  TLS            0x00000000000b6120 0x00000000006b6120 0x00000000006b6120
                 0x0000000000000020 0x0000000000000060  R      0x8
  GNU_STACK      0x0000000000000000 0x0000000000000000 0x0000000000000000
                 0x0000000000000000 0x0000000000000000  RW     0x10
  GNU_RELRO      0x00000000000b6120 0x00000000006b6120 0x00000000006b6120
                 0x0000000000002ee0 0x0000000000002ee0  R      0x1

 Section to Segment mapping:
  Segment Sections...
   00     .note.ABI-tag .note.gnu.build-id .rela.plt .init .plt .text __libc_freeres_fn __libc_thread_freeres_fn .fini .rodata .stapsdt.base .eh_frame .gcc_except_table
   01     .tdata .init_array .fini_array .data.rel.ro .got .got.plt .data __libc_subfreeres __libc_IO_vtables __libc_atexit __libc_thread_subfreeres .bss __libc_freeres_ptrs
   02     .note.ABI-tag .note.gnu.build-id
   03     .tdata .tbss
   04
   05     .tdata .init_array .fini_array .data.rel.ro .got

</code></pre></div></div>

<p>动态链接：<strong>运行时</strong>才将用到的lib so进行链接</p>

<p>静态链接：将所有模块使用的文件都链接到一起，形成一个可执行文件</p>

<p>动态链接好处：兼容性和扩展性</p>

<p>动态链接坏处：模块更新后，旧的模块接口和新模块接口不兼容则容易出现程序无法跑的情况</p>

<p>动态链接文件：dynamic shared objects。so文件</p>

<p>windows 动态链接文件：dll</p>

<p>判断dso是否为PIC文件</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>gcc <span class="nt">-fPIC</span> hello.c <span class="nt">-o</span> hello.so
readelf <span class="nt">-d</span> hello.so | <span class="nb">grep </span>TEXTREL //无输出则是PIC文件。PIC不包含段重定位表
</code></pre></div></div>

<h2 id="10-栈">10 栈</h2>

<p><img src="../images/2023-10-7-self_cultivation_of_programmers.assets/image-20231007115310362.png" alt="image-20231007115310362" style="zoom:67%;" /></p>

<h2 id="12-系统调用与api">12 系统调用与API</h2>

<p>cpu规格：</p>

<p>100MHZ： 每1s CPU可执行100000000个指令周期</p>

<p>1000MHZ: 每1s CPU可执行1000个指令周期</p>

<p><img src="../images/2023-10-7-self_cultivation_of_programmers.assets/image-20231007103136489.png" alt="image-20231007103136489" style="zoom:50%;" /></p>


  </section>
</article>

<section>

            <div class="content-play">
              <p><a href="javascript:void(0)" onclick="dashangToggle()" class="dashang" title="打赏，支持一下">打赏一个呗</a></p>
              <div class="hide_box-play"></div>
              <div class="shang_box-play">
                <a class="shang_close-play" href="javascript:void(0)" onclick="dashangToggle()" title="关闭"><img src="/images/payimg/close.jpg" alt="取消" /></a>
                <div class="shang_tit-play">
                  <p>感谢您的支持，我会继续努力的!</p>
                </div>
                <div class="shang_payimg">
                    <img src="/images/payimg/alipayimg.jpg" alt="扫码支持" title="扫一扫" />
                </div>
              <div class="shang_payimg">    
                    <img src="/images/payimg/weipayimg.jpg" alt="扫码支持" title="扫一扫" />
                </div>
                <div class="pay_explain">扫码打赏，你说多少就多少</div>
                <div class="shang_payselect">
                  <div class="pay_item checked" data-id="alipay">
                    <span class="pay_logo"><img src="/images/payimg/alipay.jpg" alt="支付宝" /></span>
                  </div>
                  <div class="pay_item" data-id="weipay">
                    <span class="pay_logo"><img src="/images/payimg/wechat.jpg" alt="微信" /></span>
                  </div>
                </div>
                <div class="shang_info-play">
                  <p>打开<span id="shang_pay_txt">支付宝</span>扫一扫，即可进行扫码打赏哦</p>
                </div>
              </div>
            </div>
            <script type="text/javascript">
            function dashangToggle(){
              $(".hide_box-play").fadeToggle();
              $(".shang_box-play").fadeToggle();
            }
            </script>

            <div style="text-align:center;margin:50px 0; font:normal 14px/24px 'MicroSoft YaHei';"></div>

            <style type="text/css">
              .content-play{width:80%;margin-top: 20px;margin-bottom: 10px;height:40px;}
              .hide_box-play{z-index:999;filter:alpha(opacity=50);background:#666;opacity: 0.5;-moz-opacity: 0.5;left:0;top:0;height:99%;width:100%;position:fixed;display:none;}
              .shang_box-play{width:540px;height:540px;padding:10px;background-color:#fff;border-radius:10px;position:fixed;z-index:1000;left:50%;top:50%;margin-left:-280px;margin-top:-280px;border:1px dotted #dedede;display:none;}
              .shang_box-play img{border:none;border-width:0;}
              .dashang{display:block;width:100px;margin:5px auto;height:25px;line-height:25px;padding:10px;background-color:#E74851;color:#fff;text-align:center;text-decoration:none;border-radius:10px;font-weight:bold;font-size:16px;transition: all 0.3s;}
              .dashang:hover{opacity:0.8;padding:15px;font-size:18px;}
              .shang_close-play{float:right;display:inline-block;
                margin-right: 10px;margin-top: 20px;
              }
              .shang_logo{display:block;text-align:center;margin:20px auto;}
              .shang_tit-play{width: 100%;height: 75px;text-align: center;line-height: 66px;color: #a3a3a3;font-size: 16px;background: url('/images/payimg/cy-reward-title-bg.jpg');font-family: 'Microsoft YaHei';margin-top: 7px;margin-right:2px;}
              .shang_tit-play p{color:#a3a3a3;text-align:center;font-size:16px;}
              .shang_payimg{width:140px;padding:10px;padding-left: 80px; /*border:6px solid #EA5F00;**/margin:0 auto;border-radius:3px;height:140px;display:inline-block;}
              .shang_payimg img{display:inline-block;margin-right:10px;float:left;text-align:center;width:140px;height:140px; }
              .pay_explain{text-align:center;margin:10px auto;font-size:12px;color:#545454;}
              .shang_payselect{text-align:center;margin:0 auto;margin-top:40px;cursor:pointer;height:60px;width:500px;margin-left:110px;}
              .shang_payselect .pay_item{display:inline-block;margin-right:140px;float:left;}
              .shang_info-play{clear:both;}
              .shang_info-play p,.shang_info-play a{color:#C3C3C3;text-align:center;font-size:12px;text-decoration:none;line-height:2em;}
            </style>

       <ul class="pager">
        
        <li class="previous">
            <a href="/2022/closure_study.html" data-toggle="tooltip" data-placement="top" title="闭包">上一篇：  <span>闭包</span>
            </a>
        </li>
        
        
        <li class="next">
            <a href="/2023/operating_systems_study.html" data-toggle="tooltip" data-placement="top" title="Operating System study">下一篇：  <span>Operating System study</span>
            </a>
        </li>
        
    </ul>
</section>

<section class="post-comments">

  

</section>


            <section class="footer">
    <footer>
        <div class = "footer_div">  
        <nav class="cover-navigation navigation--social">
          <ul class="navigation">

          

          
          
          

          

          <!-- RSS -->
          <li class="navigation__item_social">
            <a href="/feed.xml" rel="author" title="RSS" target="_blank">
              <i class='social fa fa-rss fa-2x'></i>
              <span class="label">RSS</span>
            </a>
          </li>

          

          </ul>
        </nav>

        </div>

        <div class = "footer_div">  
           <p class="copyright text-muted">
            Copyright &copy; keep moving 2025 Theme by <a href="http://claudia1204.github.io/">claudia1204</a> |
            <iframe
                style="margin-left: 2px; margin-bottom:-5px;"
                frameborder="0" scrolling="0" width="91px" height="20px"
                src="https://ghbtns.com/github-btn.html?user=claudia1204&repo=claudia1204.github.io&type=star&count=true" >
            </iframe>
            </p>
        	<div align="right">
    			<link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.3.0/css/font-awesome.min.css">

          <!-- 访问统计 -->
          <span id="busuanzi_container_site_pv">
            本站总访问量
            <span id="busuanzi_value_site_pv"></span>次
          </span>

        </div>
        <div>
    </footer>
</section>

        </div>
    </div>

    <script type="text/javascript" src="//code.jquery.com/jquery-1.11.3.min.js"></script>
<script type="text/javascript" src="/js/main.js"></script>

<script type="text/javascript" src="/js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>



  </body>

</html>
